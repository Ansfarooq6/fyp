<%- include('../includes/head.ejs') %>
<link rel="stylesheet" href="/css/forms.css">
<link rel="stylesheet" href="/css/navbar.css">
</head>

<body>
    <%- include('../includes/mocknav.ejs') %>

    <main class="form-container">
        <h1><% if (editing) { %>Edit Course<% } else { %>Add Course<% } %></h1>
        <% if (errorMessage && errorMessage.length > 0) { %>
            <div class="user-message user-message--error">
                <% errorMessage.forEach(error => { %>
                    <p><%= error.msg %></p>
                <% }) %>
            </div>
        <% } %>

        <form class="course-form" action="/admin/<% if (editing) { %>edit-course/<%= course._id %><% } else { %>add-course<% } %>" method="POST">
            <% if (editing) { %>
                <input type="hidden" value="<%= course._id %>" name="courseId">
            <% } %>
            <div class="form-control">
                <label for="courseName">Course Name</label>
                <input type="text" id="courseName" name="courseName" value="<%= editing ? course.courseName : oldInput.courseName %>" required>
            </div>
            <div class="form-control">
                <label for="availableSlots">Available Slots</label>
                <input type="number" id="availableSlots" name="availableSlots" value="<%= editing ? course.availableSlots : oldInput.availableSlots %>" required>
            </div>
            <div class="form-control">
                <label for="availableDays">Available Days (comma-separated)</label>
                <input type="text" id="availableDays" name="availableDays" value="<%= editing ? course.availableDays.join(', ') : oldInput.availableDays %>" required>
            </div>
            <div class="form-control">
                <label for="mode">Mode</label>
                <select id="mode" name="mode" required>
                    <option value="online" <%= editing && course.mode === 'online' ? 'selected' : '' %>>Online</option>
                    <option value="physical" <%= editing && course.mode === 'physical' ? 'selected' : '' %>>Physical</option>
                </select>
            </div>
            <div class="form-control">
                <label for="courseDuration">Course Duration</label>
                <input type="text" id="courseDuration" name="courseDuration" value="<%= editing ? course.courseDuration : oldInput.courseDuration %>" required>
            </div>
            <div class="form-control">
                <label for="courseFee">Course Fee</label>
                <input type="number" id="courseFee" name="courseFee" value="<%= editing ? course.courseFee : oldInput.courseFee %>" required>
            </div>
            <div class="form-control">
                <label for="lastDateToApply">Last Date to Apply</label>
                <input type="date" id="lastDateToApply" name="lastDateToApply" value="<%= editing ? course.lastDateToApply.toISOString().split('T')[0] : oldInput.lastDateToApply %>" required>
            </div>
            <div class="form-control">
                <label for="courseDescription">Course Description</label>
                <textarea id="courseDescription" name="courseDescription" rows="5" required><%= editing ? course.courseDescription : oldInput.courseDescription %></textarea>
            </div>
            <input type="hidden" name="_csrf" value="<%= csrfToken %>">
            <button class="btn" type="submit"><% if (editing) { %>Update Course<% } else { %>Add Course<% } %></button>
        </form>
    </main>

    <%- include('../includes/end.ejs') %>
</body>
</html>
